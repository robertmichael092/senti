<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Senti</title>

<style>
:root{
  --green:#1f7f55;
  --red:#b54747;
  --bg:#faf7f2;
  --card:#ffffff;
}
body{
  margin:0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background:var(--bg);
  color:#111;
}
.hidden{display:none}
.app{max-width:420px;margin:auto;padding:16px}

/* Header */
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:12px;
}
.logo{
  font-size:34px;
  font-weight:800;
}
.logo span{
  color:var(--green);
}
.header-right{
  display:flex;
  gap:8px;
  align-items:center;
}
.lang{
  font-weight:600;
  cursor:pointer;
}
.year-btn{
  background:#eee;
  border-radius:999px;
  padding:8px 14px;
  cursor:pointer;
}

/* Cards */
.card{
  background:var(--card);
  border-radius:18px;
  padding:20px;
  margin-bottom:16px;
}
.big{
  font-size:44px;
  font-weight:800;
}
.row{
  display:flex;
  justify-content:space-between;
  margin-top:10px;
}
.in{color:var(--green)}
.out{color:var(--red)}

.list li{
  display:flex;
  justify-content:space-between;
  padding:12px 0;
  border-bottom:1px solid #eee;
}
.list li:last-child{border-bottom:none}

.btn{
  background:var(--green);
  color:#fff;
  padding:16px;
  border-radius:999px;
  text-align:center;
  font-size:18px;
  margin-top:16px;
  cursor:pointer;
}
.btn.light{
  background:#e8f3ee;
  color:var(--green);
}

/* Add */
input{
  width:100%;
  padding:14px;
  margin-top:10px;
  font-size:16px;
}
.type-toggle{
  display:flex;
  margin-bottom:10px;
}
.type-toggle div{
  flex:1;
  padding:14px;
  text-align:center;
  border:1px solid #ddd;
  cursor:pointer;
}
.type-toggle .active{
  background:var(--green);
  color:#fff;
}
</style>
</head>

<body>
<div class="app">

<header>
  <div class="logo">Senti<span>â€¢</span></div>
  <div class="header-right">
    <div class="lang" id="langToggle">EN</div>
    <div class="year-btn" id="goYear"></div>
  </div>
</header>

<!-- HOME -->
<section id="home">
  <div class="card">
    <div id="homeTitle"></div>
    <div class="big" id="homeBalance">0</div>
    <div class="row">
      <div class="in" id="homeIn"></div>
      <div class="out" id="homeOut"></div>
    </div>
  </div>

  <div class="card">
    <h3 id="whereTitle"></h3>
    <ul class="list" id="homeCats"></ul>
    <div class="btn light hidden" id="toggleCats"></div>
  </div>

  <div class="btn" id="goAdd"></div>
</section>

<!-- YEAR -->
<section id="year" class="hidden">
  <div class="card">
    <h2 id="yearTitle"></h2>
    <ul class="list" id="yearList"></ul>
    <div class="btn light" id="backHome"></div>
  </div>
</section>

<!-- ADD -->
<section id="add" class="hidden">
  <div class="card">
    <div class="type-toggle">
      <div id="typeIn" class="active"></div>
      <div id="typeOut"></div>
    </div>
    <input id="amount" type="number" placeholder="0"/>
    <input id="category"/>
    <input id="note"/>
    <div class="btn" id="save"></div>
    <div class="btn light" id="cancel"></div>
  </div>
</section>

</div>

<script>
/* ---------- LANGUAGE ---------- */
const MONTHS = {
  EN:["January","February","March","April","May","June","July","August","September","October","November","December"],
  SW:["Januari","Februari","Machi","Aprili","Mei","Juni","Julai","Agosti","Septemba","Oktoba","Novemba","Desemba"]
};

const TEXT = {
  EN:{
    thisMonth:"This Month",
    moneyIn:"Money In",
    moneyOut:"Money Out",
    where:"Where your money went",
    add:"Add Entry",
    viewAll:"View all categories",
    showLess:"Show less",
    year:"Year",
    thisYear:"This Year",
    back:"Back",
    in:"Money In",
    out:"Money Out"
  },
  SW:{
    thisMonth:"Mwezi huu",
    moneyIn:"Mapato",
    moneyOut:"Matumizi",
    where:"Matumizi yako",
    add:"Ongeza",
    viewAll:"Tazama yote",
    showLess:"Ficha",
    year:"Mwaka",
    thisYear:"Mwaka huu",
    back:"Rudi",
    in:"Mapato",
    out:"Matumizi"
  }
};

let lang = localStorage.getItem("lang") || "EN";
langToggle.onclick = () => {
  lang = lang==="EN"?"SW":"EN";
  localStorage.setItem("lang",lang);
  renderHome();
};

function t(k){ return TEXT[lang][k]; }
function fmt(n){ return n.toLocaleString(); }

/* ---------- DATA ---------- */
let entries = JSON.parse(localStorage.getItem("senti")||"[]");
let expanded=false;
let type="in";

/* ---------- NAV ---------- */
function show(id){
  ["home","year","add"].forEach(s=>document.getElementById(s).classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
}

/* ---------- HOME ---------- */
function renderHome(){
  langToggle.textContent=lang;
  goYear.textContent=t("year");
  homeTitle.textContent=t("thisMonth");

  const now=new Date();
  let inc=0,out=0,cats={};

  entries.forEach(e=>{
    const d=new Date(e.date);
    if(d.getMonth()==now.getMonth()&&d.getFullYear()==now.getFullYear()){
      if(e.type==="in") inc+=e.amount;
      else{
        out+=e.amount;
        cats[e.category]=(cats[e.category]||0)+e.amount;
      }
    }
  });

  homeBalance.textContent=fmt(inc-out);
  homeIn.textContent=`${t("moneyIn")} ${fmt(inc)}`;
  homeOut.textContent=`${t("moneyOut")} ${fmt(out)}`;

  whereTitle.textContent=t("where");
  homeCats.innerHTML="";
  const all=Object.entries(cats);
  (expanded?all:all.slice(0,3)).forEach(([c,v])=>{
    homeCats.innerHTML+=`<li><span>${c}</span><strong>${fmt(v)}</strong></li>`;
  });

  toggleCats.classList.toggle("hidden",all.length<=3);
  toggleCats.textContent=expanded?t("showLess"):t("viewAll");
  goAdd.textContent=t("add");
}

/* ---------- YEAR ---------- */
function renderYear(){
  yearTitle.textContent=t("thisYear");
  yearList.innerHTML="";
  const map={};

  entries.forEach(e=>{
    const d=new Date(e.date);
    const k=`${d.getFullYear()}-${d.getMonth()}`;
    map[k]=map[k]||{in:0,out:0};
    map[k][e.type]+=e.amount;
  });

  Object.keys(map).sort().reverse().forEach(k=>{
    const [y,m]=k.split("-");
    const label=`${MONTHS[lang][m]} ${y}`;
    const bal=map[k].in-map[k].out;
    yearList.innerHTML+=`<li><span>${label}</span><strong>${fmt(bal)}</strong></li>`;
  });

  backHome.textContent=t("back");
}

/* ---------- ADD ---------- */
typeIn.textContent=t("in");
typeOut.textContent=t("out");
typeIn.onclick=()=>{type="in";typeIn.classList.add("active");typeOut.classList.remove("active")};
typeOut.onclick=()=>{type="out";typeOut.classList.add("active");typeIn.classList.remove("active")};

save.textContent=t("add");
cancel.textContent=t("back");

save.onclick=()=>{
  const amt=Number(amount.value);
  if(!amt)return;
  entries.push({
    type,
    amount:amt,
    category:category.value||"Other",
    note:note.value||"",
    date:new Date().toISOString()
  });
  localStorage.setItem("senti",JSON.stringify(entries));
  amount.value=category.value=note.value="";
  show("home");
  renderHome();
};

/* ---------- EVENTS ---------- */
goAdd.onclick=()=>show("add");
goYear.onclick=()=>{renderYear();show("year")};
backHome.onclick=()=>show("home");
toggleCats.onclick=()=>{expanded=!expanded;renderHome()};
cancel.onclick=()=>show("home");

/* INIT */
renderHome();
</script>
</body>
      </html>
